

    /*       _ __ ___   ___ _ __ ___ _   _ _ __ _   _
            | '_ ` _ \ / _ \ '__/ __| | | | '__| | | |
            | | | | | |  __/ | | (__| |_| | |  | |_| |
            |_| |_| |_|\___|_|  \___|\__,_|_|   \__, |
                                                |___/
    */

    list MercuryTermL0 = [
        4.40250710144, 0, 0,
        0.40989414976, 1.48302034194, 26087.9031415742,
        0.05046294199, 4.4778548954, 52175.8062831484,
        0.00855346843, 1.16520322351, 78263.7094247226,
        0.00165590362, 4.11969163181, 104351.612566297,
        0.00034561897, 0.77930765817, 130439.515707871,
        7.583476e-005, 3.7134840051, 156527.418849445,
        3.55974e-005, 1.51202669419, 1109.3785520934,
        1.803463e-005, 4.1033317841, 5661.3320491522,
        1.726012e-005, 0.35832239908, 182615.321991019,
        1.589923e-005, 2.99510417815, 25028.521211385,
        1.364682e-005, 4.59918318745, 27197.2816936676,
        1.017332e-005, 0.8803143904, 31749.2351907264,
        7.14182e-006, 1.54144865265, 24978.5245894808,
        6.43759e-006, 5.30266110787, 21535.9496445154,
        4.51137e-006, 6.04989275289, 51116.4243529592,
        4.042e-006, 3.28228847025, 208703.225132594,
        3.52441e-006, 5.24156297101, 20426.571092422,
        3.45212e-006, 2.79211901539, 15874.6175953632,
        3.43313e-006, 5.76531885335, 955.5997416086,
        3.39214e-006, 5.86327765, 25558.2121764796,
        3.25335e-006, 1.3367433478, 53285.1848352418,
        2.72947e-006, 2.49451163975, 529.6909650946,
        2.64336e-006, 3.91705094013, 57837.1383323006,
        2.59587e-006, 0.98732428184, 4551.9534970588,
        2.38793e-006, 0.11343953378, 1059.3819301892,
        2.3483e-006, 0.266721189, 11322.6640983044,
        2.16645e-006, 0.65987207348, 13521.7514415914,
        2.08995e-006, 2.09178234008, 47623.8527860896,
        1.83359e-006, 2.62878670784, 27043.5028831828,
        1.81629e-006, 2.43413502466, 25661.3049506982,
        1.75965e-006, 4.53636829858, 51066.427731055,
        1.72643e-006, 2.45200164173, 24498.8302462904,
        1.42316e-006, 3.36003948842, 37410.5672398786,
        1.37942e-006, 0.29098447849, 10213.285546211,
        1.25219e-006, 3.72079804425, 39609.6545831656,
        1.18233e-006, 2.78149786369, 77204.3274945334,
        1.06422e-006, 4.20572116254, 19804.8272915828
    ];

    list MercuryTermL1 = [
        26088.1470622275, 0, 0,
        0.01126007832, 6.21703970996, 26087.9031415742,
        0.00303471395, 3.05565472363, 52175.8062831484,
        0.00080538452, 6.10454743366, 78263.7094247226,
        0.00021245035, 2.83531934452, 104351.612566297,
        5.592094e-005, 5.82675673328, 130439.515707871,
        1.472233e-005, 2.51845458395, 156527.418849445,
        3.88318e-006, 5.48039225891, 182615.321991019,
        3.52244e-006, 3.05238094403, 1109.3785520934,
        1.02743e-006, 2.14879173777, 208703.225132594,
        9.354e-007, 6.11791163931, 27197.2816936676,
        9.0579e-007, 0.00045481669, 24978.5245894808,
        5.1941e-007, 5.62107554052, 5661.3320491522,
        4.437e-007, 4.57348500464, 25028.521211385,
        2.807e-007, 3.04195430989, 51066.427731055,
        2.7295e-007, 5.09210138837, 234791.128274168
    ];

    list MercuryTermL2 = [
        0.00053049845, 0, 0,
        0.00016903658, 4.69072300649, 26087.9031415742,
        7.396711e-005, 1.34735624669, 52175.8062831484,
        3.018297e-005, 4.45643539705, 78263.7094247226,
        1.107419e-005, 1.26226537554, 104351.612566297,
        3.78173e-006, 4.319980559, 130439.515707871,
        1.22998e-006, 1.06868541052, 156527.418849445,
        3.8663e-007, 4.08011610182, 182615.321991019,
        1.4898e-007, 4.6334308581, 1109.3785520934,
        1.1861e-007, 0.79187646439, 208703.225132594
    ];

    list MercuryTermL3 = [
        1.88077e-006, 0.03466830117, 52175.8062831484,
        1.42152e-006, 3.125054526, 26087.9031415742,
        9.6877e-007, 3.00378171915, 78263.7094247226,
        4.3669e-007, 6.01867965826, 104351.612566297,
        3.5395e-007, 0, 0,
        1.8045e-007, 2.77538373991, 130439.515707871,
        6.971e-008, 5.81808665742, 156527.418849445,
        2.556e-008, 2.57014364454, 182615.321991019
    ];

    list MercuryTermL4 = [
        1.14078e-006, 3.14159265359, 0,
        3.247e-008, 2.02848007619, 26087.9031415742,
        1.914e-008, 1.41731803758, 78263.7094247226,
        1.727e-008, 4.50137643801, 52175.8062831484,
        1.237e-008, 4.49970181057, 104351.612566297,
        6.45e-009, 1.26591776986, 130439.515707871
    ];

    list MercuryTermL5 = [
        8.77e-009, 3.14159265359, 0
    ];

    list MercuryTermB0 = [
        0.11737528962, 1.98357498767, 26087.9031415742,
        0.02388076996, 5.03738959685, 52175.8062831484,
        0.01222839532, 3.14159265359, 0,
        0.0054325181, 1.79644363963, 78263.7094247226,
        0.0012977877, 4.83232503961, 104351.612566297,
        0.00031866927, 1.58088495667, 130439.515707871,
        7.963301e-005, 4.60972126348, 156527.418849445,
        2.014189e-005, 1.35324164694, 182615.321991019,
        5.13953e-006, 4.37835409309, 208703.225132594,
        2.08584e-006, 2.02020294153, 24978.5245894808,
        2.07674e-006, 4.91772564073, 27197.2816936676,
        1.32013e-006, 1.11908492283, 234791.128274168,
        1.21395e-006, 1.81271752059, 53285.1848352418,
        1.00454e-006, 5.65684734206, 20426.571092422
    ];

    list MercuryTermB1 = [
        0.00429151362, 3.50169780393, 26087.9031415742,
        0.00146233668, 3.14159265359, 0,
        0.00022675295, 0.0151536688, 52175.8062831484,
        0.00010894981, 0.48540174006, 78263.7094247226,
        6.353462e-005, 3.42943919982, 104351.612566297,
        2.495743e-005, 0.16051210665, 130439.515707871,
        8.59585e-006, 3.18452433647, 156527.418849445,
        2.77503e-006, 6.21020774184, 182615.321991019,
        8.6233e-007, 2.95244391822, 208703.225132594,
        2.7696e-007, 0.29068938889, 27197.2816936676,
        2.6133e-007, 5.97708962692, 234791.128274168
    ];

    list MercuryTermB2 = [
        0.00011830934, 4.79065585784, 26087.9031415742,
        1.913516e-005, 0, 0,
        1.044801e-005, 1.21216540536, 52175.8062831484,
        2.66213e-006, 4.43418336532, 78263.7094247226,
        1.7028e-006, 1.62255638714, 104351.612566297,
        9.63e-007, 4.80023692017, 130439.515707871,
        4.4692e-007, 1.60758267772, 156527.418849445,
        1.8316e-007, 4.66904655377, 182615.321991019,
        6.927e-008, 1.4340488893, 208703.225132594
    ];

    list MercuryTermB3 = [
        2.35423e-006, 0.35387524604, 26087.9031415742,
        1.60537e-006, 0, 0,
        1.8904e-007, 4.36275460261, 52175.8062831484,
        6.376e-008, 2.50715381439, 78263.7094247226,
        4.58e-008, 6.14257817571, 104351.612566297,
        3.061e-008, 3.12497552681, 130439.515707871,
        1.732e-008, 6.26642412058, 156527.418849445
    ];

    list MercuryTermB4 = [
        4.276e-008, 1.74579932115, 26087.9031415742,
        1.023e-008, 3.14159265359, 0
    ];

    list MercuryTermR0 = [
        0.39528271652, 0, 0,
        0.07834131817, 6.19233722599, 26087.9031415742,
        0.00795525557, 2.95989690096, 52175.8062831484,
        0.00121281763, 6.01064153805, 78263.7094247226,
        0.00021921969, 2.77820093975, 104351.612566297,
        4.354065e-005, 5.82894543257, 130439.515707871,
        9.18228e-006, 2.59650562598, 156527.418849445,
        2.89955e-006, 1.42441936951, 25028.521211385,
        2.60033e-006, 3.02817753482, 27197.2816936676,
        2.01855e-006, 5.6472504035, 182615.321991019,
        2.01499e-006, 5.59227724202, 31749.2351907264,
        1.4198e-006, 6.25264202645, 24978.5245894808,
        1.00144e-006, 3.73435608689, 21535.9496445154
    ];

    list MercuryTermR1 = [
        0.00217347739, 4.65617158663, 26087.9031415742,
        0.00044141826, 1.42385543975, 52175.8062831484,
        0.00010094479, 4.47466326316, 78263.7094247226,
        2.432804e-005, 1.24226083435, 104351.612566297,
        1.624367e-005, 0, 0,
        6.03996e-006, 4.29303116561, 130439.515707871,
        1.52851e-006, 1.0606077981, 156527.418849445,
        3.9202e-007, 4.11136751416, 182615.321991019
     ];

    list MercuryTermR2 = [
        3.117867e-005, 3.08231840296, 26087.9031415742,
        1.245396e-005, 6.15183317423, 52175.8062831484,
        4.24822e-006, 2.9258335296, 78263.7094247226,
        1.3613e-006, 5.97983925842, 104351.612566297,
        4.2175e-007, 2.74936980629, 130439.515707871,
        2.1759e-007, 3.14159265359, 0,
        1.2793e-007, 5.80143162209, 156527.418849445
     ];

    list MercuryTermR3 = [
        3.2676e-007, 1.67971635359, 26087.9031415742,
        2.4166e-007, 4.63403168997, 52175.8062831484,
        1.2133e-007, 1.38983781545, 78263.7094247226,
        5.14e-008, 4.4391538693, 104351.612566297,
        1.981e-008, 1.20733880274, 130439.515707871
    ];

    list posMercury(integer jd, float jdf) {
        float tau = ((jd - 2451545) / 365250.0) + (jdf / 365250.0);
        float tau2 = tau * tau;
        float tau3 = tau2 * tau;
        float tau4 = tau3 * tau;
        float tau5 = tau4 * tau;

        float L = 0;
        float B = 0;
        float R = 0;

        integer i;
        integer n;
        float x;

        //  L0

        n = llGetListLength(MercuryTermL0);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermL0, i) *
                llCos(llList2Float(MercuryTermL0, i + 1) +
                      llList2Float(MercuryTermL0, i + 2) * tau);
        }
        L += x;

        //  L1

        n = llGetListLength(MercuryTermL1);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermL1, i) *
                llCos(llList2Float(MercuryTermL1, i + 1) +
                      llList2Float(MercuryTermL1, i + 2) * tau);
        }
        L += x * tau;

        //  L2

        n = llGetListLength(MercuryTermL2);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermL2, i) *
                llCos(llList2Float(MercuryTermL2, i + 1) +
                      llList2Float(MercuryTermL2, i + 2) * tau);
        }
        L += x * tau2;

        //  L3

        n = llGetListLength(MercuryTermL3);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermL3, i) *
                llCos(llList2Float(MercuryTermL3, i + 1) +
                      llList2Float(MercuryTermL3, i + 2) * tau);
        }
        L += x * tau3;

        //  L4

        n = llGetListLength(MercuryTermL4);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermL4, i) *
                llCos(llList2Float(MercuryTermL4, i + 1) +
                      llList2Float(MercuryTermL4, i + 2) * tau);
        }
        L += x * tau4;

        //  L5

        n = llGetListLength(MercuryTermL5);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermL5, i) *
                llCos(llList2Float(MercuryTermL5, i + 1) +
                      llList2Float(MercuryTermL5, i + 2) * tau);
        }
        L += x * tau5;

        //  B0

        n = llGetListLength(MercuryTermB0);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermB0, i) *
                llCos(llList2Float(MercuryTermB0, i + 1) +
                      llList2Float(MercuryTermB0, i + 2) * tau);
        }
        B += x;

        //  B1

        n = llGetListLength(MercuryTermB1);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermB1, i) *
                llCos(llList2Float(MercuryTermB1, i + 1) +
                      llList2Float(MercuryTermB1, i + 2) * tau);
        }
        B += x * tau;

        //  B2

        n = llGetListLength(MercuryTermB2);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermB2, i) *
                llCos(llList2Float(MercuryTermB2, i + 1) +
                      llList2Float(MercuryTermB2, i + 2) * tau);
        }
        B += x * tau2;

        //  B3

        n = llGetListLength(MercuryTermB3);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermB3, i) *
                llCos(llList2Float(MercuryTermB3, i + 1) +
                      llList2Float(MercuryTermB3, i + 2) * tau);
        }
        B += x * tau3;

        //  B4

        n = llGetListLength(MercuryTermB4);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermB4, i) *
                llCos(llList2Float(MercuryTermB4, i + 1) +
                      llList2Float(MercuryTermB4, i + 2) * tau);
        }
        B += x * tau4;

        //  R0

        n = llGetListLength(MercuryTermR0);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermR0, i) *
                llCos(llList2Float(MercuryTermR0, i + 1) +
                      llList2Float(MercuryTermR0, i + 2) * tau);
        }
        R += x;

        //  R1

        n = llGetListLength(MercuryTermR1);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermR1, i) *
                llCos(llList2Float(MercuryTermR1, i + 1) +
                      llList2Float(MercuryTermR1, i + 2) * tau);
        }
        R += x * tau;

        //  R2

        n = llGetListLength(MercuryTermR2);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermR2, i) *
                llCos(llList2Float(MercuryTermR2, i + 1) +
                      llList2Float(MercuryTermR2, i + 2) * tau);
        }
        R += x * tau2;

        //  R3

        n = llGetListLength(MercuryTermR3);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(MercuryTermR3, i) *
                llCos(llList2Float(MercuryTermR3, i + 1) +
                      llList2Float(MercuryTermR3, i + 2) * tau);
        }
        R += x * tau3;

        return [ fixangr(L), B, R ];
    }

   /*       __   _____ _ __  _   _ ___
            \ \ / / _ \ '_ \| | | / __|
             \ V /  __/ | | | |_| \__ \
              \_/ \___|_| |_|\__,_|___/
    */
    list VenusTermL0 = [
        3.17614666774, 0, 0,
        0.01353968419, 5.59313319619, 10213.285546211,
        0.00089891645, 5.30650048468, 20426.571092422,
        5.477201e-005, 4.41630652531, 7860.4193924392,
        3.455732e-005, 2.69964470778, 11790.6290886588,
        2.372061e-005, 2.99377539568, 3930.2096962196,
        1.664069e-005, 4.2501893503, 1577.3435424478,
        1.438322e-005, 4.15745043958, 9683.5945811164,
        1.317108e-005, 5.18668219093, 26.2983197998,
        1.200521e-005, 6.15357115319, 30639.856638633,
        7.69314e-006, 0.81629615911, 9437.762934887,
        7.6138e-006, 1.9501470212, 529.6909650946,
        7.07676e-006, 1.06466707214, 775.522611324,
        5.84836e-006, 3.99839884762, 191.4482661116,
        4.99915e-006, 4.12340210074, 15720.8387848784,
        4.29498e-006, 3.58642859752, 19367.1891622328,
        3.26967e-006, 5.67736583705, 5507.5532386674,
        3.26221e-006, 4.59056473097, 10404.7338123226,
        2.31937e-006, 3.16251057072, 9153.9036160218,
        1.79695e-006, 4.65337915578, 1109.3785520934,
        1.55464e-006, 5.57043888948, 19651.048481098,
        1.28263e-006, 4.22604493736, 20.7753954924,
        1.27907e-006, 0.96209822685, 5661.3320491522,
        1.05547e-006, 1.53721191253, 801.8209311238
    ];

    list VenusTermL1 = [
        10213.529430529, 0, 0,
        0.00095707712, 2.46424448979, 10213.285546211,
        0.00014444977, 0.51624564679, 20426.571092422,
        2.13374e-006, 1.79547929368, 30639.856638633,
        1.73904e-006, 2.65535879443, 26.2983197998,
        1.51669e-006, 6.10635282369, 1577.3435424478,
        8.2233e-007, 5.7023413373, 191.4482661116,
        6.9734e-007, 2.68136034979, 9437.762934887,
        5.2408e-007, 3.60013087656, 775.522611324,
        3.8318e-007, 1.03379038025, 529.6909650946,
        2.9633e-007, 1.25056322354, 5507.5532386674,
        2.5056e-007, 6.10664792855, 10404.7338123226
    ];

    list VenusTermL2 = [
        0.00054127076, 0, 0,
        3.89146e-005, 0.34514360047, 10213.285546211,
        1.33788e-005, 2.02011286082, 20426.571092422,
        2.3836e-007, 2.04592119012, 26.2983197998,
        1.9331e-007, 3.53527371458, 30639.856638633,
        9.984e-008, 3.97130221102, 775.522611324,
        7.046e-008, 1.51962593409, 1577.3435424478,
        6.014e-008, 0.99926757893, 191.4482661116
    ];

    list VenusTermL3 = [
        1.35742e-006, 4.80389020993, 10213.285546211,
        7.7846e-007, 3.66876371591, 20426.571092422,
        2.6023e-007, 0, 0
    ];

    list VenusTermL4 = [
        1.14016e-006, 3.14159265359, 0,
        3.209e-008, 5.20514170164, 20426.571092422,
        1.714e-008, 2.51099591706, 10213.285546211
    ];

    list VenusTermL5 = [
        8.74e-009, 3.14159265359, 0
    ];

    list VenusTermB0 = [
        0.05923638472, 0.26702775813, 10213.285546211,
        0.00040107978, 1.14737178106, 20426.571092422,
        0.00032814918, 3.14159265359, 0,
        1.011392e-005, 1.08946123021, 30639.856638633,
        1.49458e-006, 6.25390296069, 18073.7049386502,
        1.37788e-006, 0.86020146523, 1577.3435424478,
        1.29973e-006, 3.67152483651, 9437.762934887,
        1.19507e-006, 3.70468812804, 2352.8661537718,
        1.07971e-006, 4.53903677647, 22003.9146348698
    ];

    list VenusTermB1 = [
        0.00513347602, 1.80364310797, 10213.285546211,
        4.3801e-005, 3.38615711591, 20426.571092422,
        1.99162e-006, 0, 0,
        1.96586e-006, 2.53001197486, 30639.856638633
    ];

    list VenusTermB2 = [
        0.00022377665, 3.38509143877, 10213.285546211,
        2.81739e-006, 0, 0,
        1.73164e-006, 5.25563766915, 20426.571092422,
        2.6945e-007, 3.87040891568, 30639.856638633
    ];

    list VenusTermB3 = [
        6.46671e-006, 4.99166565277, 10213.285546211,
        1.9952e-007, 3.14159265359, 0,
        5.54e-008, 0.77376923951, 20426.571092422,
        2.526e-008, 5.4449376302, 30639.856638633
    ];

    list VenusTermB4 = [
        1.4102e-007, 0.31537190181, 10213.285546211
    ];

    list VenusTermR0 = [
        0.72334820905, 0, 0,
        0.00489824185, 4.02151832268, 10213.285546211,
        1.658058e-005, 4.90206728012, 20426.571092422,
        1.632093e-005, 2.84548851892, 7860.4193924392,
        1.378048e-005, 1.128465906, 11790.6290886588,
        4.98399e-006, 2.58682187717, 9683.5945811164,
        3.73958e-006, 1.42314837063, 3930.2096962196,
        2.63616e-006, 5.5293818592, 9437.762934887,
        2.37455e-006, 2.55135903978, 15720.8387848784,
        2.21983e-006, 2.01346776772, 19367.1891622328,
        1.25896e-006, 2.72769833559, 1577.3435424478,
        1.19467e-006, 3.01975365264, 10404.7338123226
    ];

    list VenusTermR1 = [
        0.00034551039, 0.89198710598, 10213.285546211,
        2.34203e-006, 1.77224942714, 20426.571092422,
        2.33998e-006, 3.14159265359, 0
    ];

    list VenusTermR2 = [
        1.406587e-005, 5.0636639519, 10213.285546211,
        1.5529e-007, 5.47321687981, 20426.571092422,
        1.3059e-007, 0, 0
    ];

    list VenusTermR3 = [
        4.9582e-007, 3.2226355452, 10213.285546211
    ];

    list VenusTermR4 = [
        5.73e-009, 0.9222969782, 10213.285546211
    ];

    list posVenus(integer jd, float jdf) {
        float tau = ((jd - 2451545) / 365250.0) + (jdf / 365250.0);
        float tau2 = tau * tau;
        float tau3 = tau2 * tau;
        float tau4 = tau3 * tau;
        float tau5 = tau4 * tau;

        float L = 0;
        float B = 0;
        float R = 0;

        integer i;
        integer n;
        float x;

        //  L0

        n = llGetListLength(VenusTermL0);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermL0, i) *
                llCos(llList2Float(VenusTermL0, i + 1) +
                      llList2Float(VenusTermL0, i + 2) * tau);
        }
        L += x;

        //  L1

        n = llGetListLength(VenusTermL1);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermL1, i) *
                llCos(llList2Float(VenusTermL1, i + 1) +
                      llList2Float(VenusTermL1, i + 2) * tau);
        }
        L += x * tau;

        //  L2

        n = llGetListLength(VenusTermL2);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermL2, i) *
                llCos(llList2Float(VenusTermL2, i + 1) +
                      llList2Float(VenusTermL2, i + 2) * tau);
        }
        L += x * tau2;

        //  L3

        n = llGetListLength(VenusTermL3);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermL3, i) *
                llCos(llList2Float(VenusTermL3, i + 1) +
                      llList2Float(VenusTermL3, i + 2) * tau);
        }
        L += x * tau3;

        //  L4

        n = llGetListLength(VenusTermL4);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermL4, i) *
                llCos(llList2Float(VenusTermL4, i + 1) +
                      llList2Float(VenusTermL4, i + 2) * tau);
        }
        L += x * tau4;

        //  L5

        n = llGetListLength(VenusTermL5);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermL5, i) *
                llCos(llList2Float(VenusTermL5, i + 1) +
                      llList2Float(VenusTermL5, i + 2) * tau);
        }
        L += x * tau5;

        //  B0

        n = llGetListLength(VenusTermB0);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermB0, i) *
                llCos(llList2Float(VenusTermB0, i + 1) +
                      llList2Float(VenusTermB0, i + 2) * tau);
        }
        B += x;

        //  B1

        n = llGetListLength(VenusTermB1);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermB1, i) *
                llCos(llList2Float(VenusTermB1, i + 1) +
                      llList2Float(VenusTermB1, i + 2) * tau);
        }
        B += x * tau;

        //  B2

        n = llGetListLength(VenusTermB2);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermB2, i) *
                llCos(llList2Float(VenusTermB2, i + 1) +
                      llList2Float(VenusTermB2, i + 2) * tau);
        }
        B += x * tau2;

        //  B3

        n = llGetListLength(VenusTermB3);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermB3, i) *
                llCos(llList2Float(VenusTermB3, i + 1) +
                      llList2Float(VenusTermB3, i + 2) * tau);
        }
        B += x * tau3;

        //  B4

        n = llGetListLength(VenusTermB4);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermB4, i) *
                llCos(llList2Float(VenusTermB4, i + 1) +
                      llList2Float(VenusTermB4, i + 2) * tau);
        }
        B += x * tau4;

        //  R0

        n = llGetListLength(VenusTermR0);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermR0, i) *
                llCos(llList2Float(VenusTermR0, i + 1) +
                      llList2Float(VenusTermR0, i + 2) * tau);
        }
        R += x;

        //  R1

        n = llGetListLength(VenusTermR1);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermR1, i) *
                llCos(llList2Float(VenusTermR1, i + 1) +
                      llList2Float(VenusTermR1, i + 2) * tau);
        }
        R += x * tau;

        //  R2

        n = llGetListLength(VenusTermR2);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermR2, i) *
                llCos(llList2Float(VenusTermR2, i + 1) +
                      llList2Float(VenusTermR2, i + 2) * tau);
        }
        R += x * tau2;

        //  R3

        n = llGetListLength(VenusTermR3);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermR3, i) *
                llCos(llList2Float(VenusTermR3, i + 1) +
                      llList2Float(VenusTermR3, i + 2) * tau);
        }
        R += x * tau3;

        //  R4

        n = llGetListLength(VenusTermR4);
        x = 0;
        for (i = 0; i < n; i += 3) {
            x += llList2Float(VenusTermR4, i) *
                llCos(llList2Float(VenusTermR4, i + 1) +
                      llList2Float(VenusTermR4, i + 2) * tau);
        }
        R += x * tau4;

        return [ fixangr(L), B, R ];
    }

    //  fixangr  --  Range reduce an angle in radians

    float fixangr(float a) {
        return a - (TWO_PI * (llFloor(a / TWO_PI)));
    }

    integer MERCURY = 1;                // Mercury body number
    integer VENUS = 2;                  // Venus body number

    integer LM_EP_CALC = 431;           // Calculate ephemeris
    integer LM_EP_RESULT = 432;         // Ephemeris calculation result
    integer LM_EP_STAT = 433;           // Print memory status

    default {
        state_entry() {
        }

        link_message(integer sender, integer num, string str, key id) {

            //  LM_EP_CALC (431): Calculate ephemeris

            if (num == LM_EP_CALC) {
                list args = llCSV2List(str);
                integer argn = llGetListLength(args);
                if (llList2Integer(args, 0) & (1 << MERCURY)) {
                    list eph = [ ];
                    integer i;

                    for (i = 1; (i + 1) < argn; i += 2) {
                        eph += posMercury(llList2Integer(args, i),
                                          llList2Float(args, i + 1));
                    }
                    integer handle = llList2Integer(args, i);
                    llMessageLinked(LINK_THIS, LM_EP_RESULT,
                        (string) MERCURY + "," +
                        llList2CSV(eph + [ handle ]), id);
                }
                if (llList2Integer(args, 0) & (1 << VENUS)) {
                    list eph = [ ];
                    integer i;

                    for (i = 1; (i + 1) < argn; i += 2) {
                        eph += posVenus(llList2Integer(args, i),
                                        llList2Float(args, i + 1));
                    }
                    integer handle = llList2Integer(args, i);
                    llMessageLinked(LINK_THIS, LM_EP_RESULT,
                        (string) VENUS + "," +
                        llList2CSV(eph + [ handle ]), id);
                }

            //  LM_EP_STAT (433): Print memory status

            } else if (num == LM_EP_STAT) {
                integer mFree = llGetFreeMemory();
                integer mUsed = llGetUsedMemory();
                llOwnerSay(llGetScriptName() + " status:" +
                     " Script memory.  Free: " + (string) mFree +
                        "  Used: " + (string) mUsed + " (" +
                        (string) ((integer) llRound((mUsed * 100.0) / (mUsed + mFree))) + "%)"
                );
            }
        }
    }
